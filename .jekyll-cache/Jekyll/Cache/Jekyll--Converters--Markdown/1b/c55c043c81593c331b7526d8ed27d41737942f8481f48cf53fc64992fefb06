I"ù
<p>Monday of last week, Magnet released the 2nd challenge for their weekly CTF. This weeks challenge is worth 30 points.</p>

<p style="text-align: center;"><img src="https://starwarsfan2099.github.io/public/2020-10-16/question.JPG" alt="Challenge question" /></p>

<p>The question asks <em>What domain was most recently viewed via an app that has picture-in-picture capability?</em> Picture-in-picture is the ability for a window, typically a video or stream, to pop out of an app and stay on the screen - even when on the homescreen or in other applications. The solution to the challenge is a domain <strong>recently viewed</strong> via an app with that capability. The wording used in the question indicates itâ€™s probably viewed by the user and not a background request by an app or something similar.</p>

<p>A quick Google search shows that several popular Android apps support PIP. Such as WhatsApp, Google Maps, Google Duo, Google Chrome, and Facebook. From the <code class="highlighter-rouge">Extraction Summary</code> page in Cellebrite, we can view the phoneâ€™s installed applications.</p>

<p style="text-align: center;"><img src="https://starwarsfan2099.github.io/public/2020-10-16/installed_applications.JPG" alt="Installed applications" /></p>

<p>Looking through the list of apps, several with PIP support are installed. The user most likely isnâ€™t going to view a domain through Google Maps or Google Duo. Chrome as well as Facebook can be used for visiting web pages though. Starting with Chrome, we can select the application and then hit <code class="highlighter-rouge">Run App Genie</code>.  AppGenie will parse the application data it can find stored in the Chrome app.</p>

<p style="text-align: center;"><img src="https://starwarsfan2099.github.io/public/2020-10-16/appgenie.JPG" alt="AppGenie" /></p>

<p>The app contains a <code class="highlighter-rouge">History</code> database. This is found at <code class="highlighter-rouge">/data/data/com.android.chrome/app_chrome/Default/History</code>. AppGenie nicely parses the data and places it in a table for us to view. We can sort the table by the <code class="highlighter-rouge">Last visited</code> time to see the most recent link visited.</p>

<p style="text-align: center;"><img src="https://starwarsfan2099.github.io/public/2020-10-16/table.JPG" alt="AppGenie table" /></p>

<p>This shows at that <code class="highlighter-rouge">http://malliesae.com/investor-page/</code> was the last visited page. The challenge question asks for the domain viewed, so our answer is <code class="highlighter-rouge">http://malliesae.com</code>. Inputting this into the answer box, and viola! #2 solved!</p>

<p style="text-align: center;"><img src="https://starwarsfan2099.github.io/public/2020-10-16/answered.JPG" alt="AppGenie table" /></p>
:ET